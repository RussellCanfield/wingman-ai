# Gateway Settings

The gateway is the collaboration hub. It manages sessions, adapters (like Discord), and the Control Core UI.

## Minimal config

```json
{
  "gateway": {
    "host": "127.0.0.1",
    "port": 18789,
    "fsRoots": ["."],
    "auth": { "mode": "none" },
    "controlUi": {
      "enabled": true,
      "port": 18790,
      "pairingRequired": true,
      "allowInsecureAuth": false
    },
    "dynamicUiEnabled": true
  }
}
```

## Auth modes

Set `gateway.auth.mode` to one of:

- `none` (default)
- `token`
- `password`

You can also provide a token via env var:

```bash
export WINGMAN_GATEWAY_TOKEN="..."
```

## Token placement (explicit)

Recommended (do not store token in JSON):

1. Set config auth mode:

```json
{
  "gateway": {
    "auth": { "mode": "token" }
  }
}
```

2. Provide token at runtime:

```bash
export WINGMAN_GATEWAY_TOKEN="your-token"
```

Fallback (less secure):

```json
{
  "gateway": {
    "auth": {
      "mode": "token",
      "token": "your-token"
    }
  }
}
```

## CLI control

```bash
wingman gateway start
wingman gateway start --discovery mdns --name "Home Gateway"
wingman gateway status
wingman gateway stop
```

Additional utilities:

```bash
wingman gateway token --generate
wingman gateway discover --verbose
wingman gateway join ws://host:port/ws --name="node-1"
```

## File system roots

`fsRoots` defines which directories are allowed when selecting a session working folder (`workdir`) in the Control UI/API.

- The selected `workdir` must be inside one of these roots.
- When set, the session `workdir` becomes the agent's active execution root (tool CWD + file backend root) for subsequent turns in that session.
- Keep this list tight to reduce risk.

## Control UI uploads

The Control UI chat supports file uploads in addition to existing media capture:

- Media (existing): image uploads, pasted screenshots, and audio/voice attachments
- Text/code files: `.txt`, `.md`, `.csv`, `.json`, `.yaml`, `.yml`, `.xml`, `.log`, `.ts`, `.js`, `.py`, `.go`, `.rs`, `.java`, `.c`, `.cpp`, `.sql`, `.html`, `.css`
- PDF: `.pdf` uploads use provider-native PDF handling when supported, with text-extraction fallback

If local PDF text extraction fails, Wingman still sends a fallback note so the request continues without breaking.

## State directory

Set `gateway.stateDir` to control where persistent data is stored (sessions, routines). If omitted, Wingman uses `.wingman/`.

## Dynamic UI

Use `gateway.dynamicUiEnabled` to enable or disable SGUI rendering in the Control UI. See the [Dynamic UI (SGUI)](/guides/dynamic-ui) guide for registry, tools, and examples.

## MCP proxy wrapper

Use `gateway.mcpProxy` to wrap stdio MCP servers with a proxy runtime (for tracing/guardrails pipelines).

```json
{
  "gateway": {
    "mcpProxy": {
      "enabled": false,
      "command": "uvx",
      "baseArgs": ["invariant-gateway@latest", "mcp"],
      "projectName": "wingman-gateway",
      "pushExplorer": false,
      "apiKey": "optional-key",
      "apiUrl": "optional-url"
    }
  }
}
```

Behavior notes:
- When disabled (`enabled: false`), MCP servers run exactly as configured.
- When enabled, Wingman rewrites stdio MCP process launches to execute through the proxy command.
- Wingman checks for `uv` only when this feature is enabled and the proxy command is `uv`/`uvx`.
- If `uv` is missing in this mode, gateway startup fails with an error (no interactive prompt).
